

-- setup new US remote link

-- eCommerce Cluster NonUS = 52.11.52.162 or http://ec2-52-11-52-162.us-west-2.compute.amazonaws.com:8091/

-- Peter's Rightscale Cluster = 54.188.70.16 or http://ec2-54-188-70-16.us-west-2.compute.amazonaws.com:8091/

./couchbase-cli analytics-link-setup \
        -c ec2-54-188-70-16.us-west-2.compute.amazonaws.com \
        -u Administrator \
        -p password \
        --create \
        --name remotelinkNonUSorders \
        --dataverse Default \
        --type couchbase \
        --hostname ec2-52-11-52-162.us-west-2.compute.amazonaws.com \
        --link-username Administrator \
        --link-password couchword \
        --encryption none


-- Create NonUS Orders DATASET
CREATE DATASET NonUSorders ON `ecommerce2020`
AT remotelinkNonUSorders
WHERE docType = 'Order'
AND billing.country != 'US';

-- Create Country Continent Master DATASET
CREATE DATASET country ON `countrycontinent`
AT remotelinkNonUSorders;

CONNECT Link remotelinkNonUSorders;

-- Create US Orders DATASET on Analytics Node
CREATE DATASET USorders ON `USecommerce`
WHERE docType = 'Order'
AND billing.country = 'US';

CONNECT Link Local;

-- CLI
  -- edit existing remote link
  ./couchbase-cli analytics-link-setup \
        -c ec2-54-188-70-16.us-west-2.compute.amazonaws.com \
        -u Administrator \
        -p password \
        --create \
        --name remotelinkNonUSorders \
        --dataverse Default\
        --type couchbase \
        --hostname ec2-52-11-52-162.us-west-2.compute.amazonaws.com \
        --link-username Administrator \
        --link-password couchword \
        --encryption none

  -- delete existing remote link
  ./couchbase-cli analytics-link-setup \
        -c ec2-54-188-70-16.us-west-2.compute.amazonaws.com \
        -u Administrator \
        -p password \
        --delete \
        --name remotelinkNonUSorders \
        --dataverse Default


  -- list existing  links
  ./couchbase-cli analytics-link-setup \
        -c ec2-54-188-70-16.us-west-2.compute.amazonaws.com \
        -u Administrator \
        -p password \
        --list \
        --dataverse Default \

-- REST API
curl -v -u Administrator:password \
     -X POST "http://ec2-54-188-70-16.us-west-2.compute.amazonaws.com:8095/analytics/link" \
     -d dataverse=Default \
     -d name=remotelinkTest \
     -d type=couchbase \
     -d hostname=ec2-52-11-52-162.us-west-2.compute.amazonaws.com \
     -d username=Administrator \
     -d password=couchword \
     -d encryption=none


curl -v -u Administrator:password \
     -X GET "http://ec2-54-188-70-16.us-west-2.compute.amazonaws.com:8095/analytics/link" \
     -d dataverse=Default \
     -d name=myS3link




